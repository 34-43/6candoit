<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>정현우 소개</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="module">
        // Firebase SDK 라이브러리 가져오기
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { collection, addDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getDocs, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // Firebase 구성 정보 설정
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyA9zC58RD2rPKiDTqciIhq3qY5b0NtoRPQ",
            authDomain: "sparta-10d8f.firebaseapp.com",
            projectId: "sparta-10d8f",
            storageBucket: "sparta-10d8f.appspot.com",
            messagingSenderId: "740890493301",
            appId: "1:740890493301:web:956981f7896ca6c548133c",
            measurementId: "G-6HR5DY5SVX"
        };

        // Firebase 인스턴스 초기화
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        //저장데이터 불러오기(하나만)
        //자신에게 해당하는 데이터의 아이디를 project_01 뒤에 넣습니다.
        const docRef = doc(db, "project_01", "Ov0Z5ToRphy3zOLEilBr");
        const docSnap = await getDoc(docRef);
        let row = docSnap.data();

        let img = row['img'];
        let name = row['name'];
        let age = row['age'];
        let mbti = row['mbti'];
        let habit = row['habit'];
        let blog_url = row['blog_url'];
        let git_url = row['git_url'];
        let comment = row['comment'];

        //read
        $('#img').append(`<img src="${img}">`);
        $('#name').append(name);
        $('#age').append(age);
        $('#mbti').append(mbti);
        $('#habit').append(habit);
        $('#blog_url').append(blog_url);
        $('#git_url').append(git_url);
        $('#comment').append(comment);

        //form value
        $('#f-img').attr('value', img);
        $('#f-name').attr('value', name);
        $('#f-age').attr('value', age);
        $('#f-mbti').attr('value', mbti);
        $('#f-habit').attr('value', habit);
        $('#f-blog_url').attr('value', blog_url);
        $('#f-git_url').attr('value', git_url);
        $('#f-comment').attr('value', comment);

        //수정하기 클릭 시
        $("#upd").click(async function () {
            $('#yes').hide();
            $('#no').css('display', 'flex');

            $('#upd').hide();
            $('#del').hide();
            $('#back-home').hide();
        })

        //수정하기>확인 클릭 시
        $("#upd-ok").click(async function () {
            let img = $('#f-img').val();
            let name = $('#f-name').val();
            let age = $('#f-age').val();
            let mbti = $('#f-mbti').val();
            let habit = $('#f-habit').val();
            let blog_url = $('#f-blog_url').val();
            let git_url = $('#f-git_url').val();
            let comment = $('#f-comment').val();

            let row = {
                'img': img,
                'name': name,
                'age': age,
                'mbti': mbti,
                'habit': habit,
                'blog_url': blog_url,
                'git_url': git_url,
                'comment': comment,
            }

            //자신에게 해당하는 데이터의 아이디를 project_01과 row사이에 넣습니다.
            await updateDoc(doc(db, 'project_01', 'Ov0Z5ToRphy3zOLEilBr'), row);
            window.location.reload();
        })

        //수정하기>취소 클릭 시
        $("#upd-no").click(async function () {
            window.location.reload();
        })

        //삭제하기 클릭시
        $("#del").click(async function () {
            var answer = confirm("정말 삭제하시겠습니까?");

            if (answer) {
                //자신에게 해당하는 데이터의 아이디를 project_01과 row사이에 넣습니다.
                await deleteDoc(doc(db, 'project_01', 'o9jXbg9suDYnnAR5fbE6'));
                window.location.href = '../index.html';
            }
        })

        //홈으로 돌아가기 클릭시
        $("#back-home").click(async function () {
            window.location.href = '../index.html';
        })

    </script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&display=swap');

        * {
                font-family: "Jua", sans-serif;
                font-weight: 400;
                font-style: normal;
        }

        .mytitle {
            width: 250px;
            height: 250px;
            margin: 20px auto 20px auto;
            color: black;
            text-align: center;
            padding: 50px;
            border-radius: 8px;
        }

        .card {
            border-color: transparent;
        }

        .image {
            margin: 20px auto 20px auto;
            width: 1000px;
        }

        .mybtn {
            width: 200px;
            margin: 20px 20px 20px auto;
            background-color: transparent;
            border-radius: 10px;
        }
    </style>

</head>

<body>
    <div class="mytitle">
        <h1>정현우</h1>
        <p>사교적인 강아지유형 (ENFP)</p>
    </div>
    <div class="image">
        <div id="card" class="row row-cols-1 row-cols-md-2 g-2">
            <div class="col1">
                <div id="img" class="card" style="align-items: center">
                    <!-- <img src="https://dareumdaroom.com/wp-content/uploads/2024/01/%EA%B0%95%EC%95%84%EC%A7%80%EC%9B%90-1024x1024-optimized.png"
                        height="500" , width="500"> -->
                </div>
            </div>
            <div class="col1">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">이름: 정현우</h5>
                        <p style="display: inline;" class="card-text">MBTI: </p>
                        <p style="display: inline;" id="mbti"></p>
                        <p></p>
                        <p style="display: inline;" class="card-text">나이: </p>
                        <p style="display: inline;" id="age"></p>
                        <p></p>
                        <p style="display: inline;" class="card-text">취미: </p>
                        <p style="display: inline;" id="habit"></p>
                        <p></p>
                        <p style="display: inline;" class="card-text">개발을 시작하게 된 계기: </p>
                        <p style="display: inline;" id="comment"></p>
                        <p></p>
                        <p style="display: inline;" class="card-text">블로그: </p>
                        <p style="display: inline;" id="blog_url"></p>
                        <p></p>
                        <p style="display: inline;" class="card-text">깃허브: </p>
                        <p style="display: inline;" id="git_url"></p>
                        <p></p>
                        <p class="card-text">객관적으로 살펴본 자신의 장점: 시간 약속을 잘 지킨다.</p>
                        <p class="card-text">자신의 협업 스타일: 상대방의 의견을 존중하고 내 의견을 말하여 절충안을 찾는 스타일</p>
                    </div>
                </div>
            </div>

            <button class="mybtn" type="button" class="btn btn-outline-success">뒤로가기</button>
        </div>

</body>

</html>