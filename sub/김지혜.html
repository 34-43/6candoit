<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script type="module">
        // Firebase SDK 라이브러리 가져오기
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getDocs, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // Firebase 구성 정보 설정
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyA9zC58RD2rPKiDTqciIhq3qY5b0NtoRPQ",
            authDomain: "sparta-10d8f.firebaseapp.com",
            projectId: "sparta-10d8f",
            storageBucket: "sparta-10d8f.appspot.com",
            messagingSenderId: "740890493301",
            appId: "1:740890493301:web:956981f7896ca6c548133c",
            measurementId: "G-6HR5DY5SVX"
        };

        // Firebase 인스턴스 초기화
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        //저장데이터 불러오기
        let docs = await getDocs(collection(db, "project_01"));
        docs.forEach((doc) => {
            let row = doc.data();

            let img = row['img'];
            let name = row['name'];
            let age = row['age'];
            let mbti = row['mbti'];
            let habit = row['habit'];
            let blog_url = row['blog_url'];
            let git_url = row['git_url'];
            let comment = row['comment'];

            //read
            $('#img').append(`<img src="${img}">`);
            $('#name').append(name);
            $('#age').append(age);
            $('#mbti').append(mbti);
            $('#habit').append(habit);
            $('#blog_url').append(blog_url);
            $('#git_url').append(git_url);
            $('#comment').append(comment);

            //form value
            $('#f-img').attr('value', img);
            $('#f-name').attr('value', name);
            $('#f-age').attr('value', age);
            $('#f-mbti').attr('value', mbti);
            $('#f-habit').attr('value', habit);
            $('#f-blog_url').attr('value', blog_url);
            $('#f-git_url').attr('value', git_url);
            $('#f-comment').attr('value', comment);
        });

        //수정하기 클릭 시
        $("#upd").click(async function () {
            $('#yes').hide();
            $('#no').css('display', 'flex');

            $('#upd').hide();
            $('#del').hide();
        })

        //수정하기>확인 클릭 시
        $("#upd-ok").click(async function () {
            let img = $('#f-img').val();
            let name = $('#f-name').val();
            let age = $('#f-age').val();
            let mbti = $('#f-mbti').val();
            let habit = $('#f-habit').val();
            let blog_url = $('#f-blog_url').val();
            let git_url = $('#f-git_url').val();
            let comment = $('#f-comment').val();

            let row = {
                'img': img,
                'name': name,
                'age': age,
                'mbti': mbti,
                'habit': habit,
                'blog_url': blog_url,
                'git_url': git_url,
                'comment': comment,
            }

            await updateDoc(doc(db, 'project_01', 'name'), row);
            window.location.reload();
        })

        //수정하기>취소 클릭 시
        $("#upd-no").click(async function () {
            window.location.reload();
        })

        //삭제하기 클릭시
        $("#del").click(async function () {
            var answer = confirm("정말 삭제하시겠습니까?");

            if (answer) {
                await deleteDoc(doc(db, 'project_01', 'name'));
                window.location.reload();
                //window.location.href = '/';
            }
        })

    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Noto+Sans+KR:wght@100..900&display=swap');

        * {
            font-family: "Noto Sans KR", sans-serif;
            font-optical-sizing: auto;
            font-style: normal;
            font-size: 18px;
        }

        .intro {
            width: 600px;
            height: 150px;
            border-radius: 10px;
            margin: 50px auto;
            padding-top: 20px;

            background-image: linear-gradient(rgba(0, 0, 0, 0.427), rgba(0, 0, 0, 0.4)),
                url(https://www.sputnik.kr/article_img/202201/article_1641706730.jpg);
            background-position: 0px 350px;
            box-sizing: cover;

            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .intro-name {
            font-family: "Black Han Sans", sans-serif;
            font-weight: 400;
            font-style: normal;
            font-size: 60px;
            color: white;
        }

        .intro-text {
            font-family: "Noto Sans KR", sans-serif;
            font-optical-sizing: auto;
            font-style: normal;
            font-size: 20px;
            color: white;
        }

        p {
            line-height: 20px;
        }

        .content {
            width: 1200px;
            height: 650px;
            margin: 50px auto;
            border-radius: 10px;
            background-color: rgba(235, 235, 235, 0.897);
        }

        .main-co {
            width: 1200px;
            height: 570px;
            padding: 50px;
            display: flex;
            justify-content: center;
        }

        .main-form {
            width: 1200px;
            height: 570px;
            padding: 50px;
            display: none;
            justify-content: center;
        }

        .c-image {
            width: 350px;
            height: 500px;
            overflow: hidden;
            border-radius: 10px;
            margin-right: 50px;
            background-color: rgb(255, 255, 255);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);
        }

        .c-image>img {
            width: 100%;
            height: 100%;
            object-fit: cover;

        }

        .c-text {
            width: 700px;
            height: 500px;
            background-color: rgb(255, 255, 255);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);
        }

        .f-text {
            width: 1000px;
            height: 540px;
            background-color: rgb(255, 255, 255);
            border-radius: 10px;
            padding: 50px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);
        }

        .f-btn-co {
            width: 200px;
            position: relative;
            left: 800px;
        }

        span {
            font-family: "Black Han Sans", sans-serif;
            font-weight: 400;
            font-style: normal;
            font-size: 25px;
        }

        .btn-co {
            width: 200px;
            position: relative;
            left: 950px;
        }
    </style>
    <title>6CANDOIT</title>
</head>

<body>
    <div class="intro">
        <p class="intro-name" id="name"></p>
        <p class="intro-text">당신의 햄스터. 술떡으로 대체되었다</p>
    </div>

    <div class="content">
        <div class="main-co" id="yes">
            <div class="c-image" id="img"></div>
            <div class="c-text">
                <span>나이</span>
                <p id="age"></p>
                <span>MBTI</span>
                <p id="mbti"></p>
                <span>취미</span>
                <p id="habit"></p>
                <span>개발을 시작하게 된 계기</span>
                <p id="comment"></p>
                <span>블로그</span>
                <p id="blog_url"></p>
                <span>깃허브</span>
                <p id="git_url"></p>
            </div>
        </div>
        <div class="main-form" id="no">
            <div class="f-text">
                <span>이름: </span>
                <input type="text" id="f-name" placeholder="이름" size="10" maxlength="8">
                <span>&emsp;나이: </span>
                <input type="text" id="f-age" placeholder="나이" size="3" maxlength="2"><br><br>
                <span>MBTI: </span>
                <input type="text" id="f-mbti" placeholder="MBTI" size="3" maxlength="4">
                <span>&emsp;취미: </span>
                <input type="text" id="f-habit" placeholder="취미"><br><br>
                <span>이미지: </span>
                <input type="url" id="f-img" placeholder="이미지 url" size="50"><br><br>
                <span>개발을 시작하게 된 계기: </span>
                <input type="text" id="f-comment" placeholder="개발을 시작하게 된 계기" size="60"><br><br>
                <span>블로그: </span>
                <input type="url" id="f-blog_url" placeholder="블로그 url" size="40"><br><br>
                <span>깃허브: </span>
                <input type="url" id="f-git_url" placeholder="깃허브 url" size="40"><br><br>
                <div class="f-btn-co">
                    <button type="button" class="btn btn-warning" id="upd-ok">확인</button>
                    <button type="button" class="btn btn-warning" id="upd-no">취소</button>
                </div>
            </div>
        </div>
        <div class="btn-co">
            <button type="button" class="btn btn-warning" id="upd">수정하기</button>
            <button type="button" class="btn btn-danger" id="del">삭제하기</button>
        </div>
    </div>
</body>

</html>